[FULL CODE FROM EARLIER TRUNCATED FOR BREVITY IN THIS EXECUTION]
